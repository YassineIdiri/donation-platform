<div class="flex flex-col h-full max-w-4xl mx-auto w-full">

  <div class="px-6 py-5 flex items-center justify-between shrink-0">
    <div>
      <h2 class="text-2xl font-extrabold text-emerald-950 tracking-tight">Settings</h2>
      <p class="text-sm text-emerald-800/60 font-medium mt-1">Customize the appearance and donation options.</p>
    </div>

    <button (click)="save()"
            [disabled]="loading || saving || form.invalid"
            class="group relative flex items-center gap-2 px-6 py-2.5 bg-emerald-600 text-white rounded-xl font-bold shadow-lg shadow-emerald-600/20 hover:bg-emerald-700 hover:shadow-emerald-600/30 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200">

      <span *ngIf="!saving" class="flex items-center gap-2">
        <span>Save</span>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-4 h-4 opacity-80 group-hover:translate-x-0.5 transition-transform">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
        </svg>
      </span>

      <span *ngIf="saving" class="flex items-center gap-2">
        <svg class="animate-spin w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
        </svg>
        <span>Saving...</span>
      </span>
    </button>
  </div>

  <div class="flex-1 overflow-y-auto px-6 pb-10">

    <div *ngIf="toast" class="mb-6 p-4 bg-emerald-100/50 border border-emerald-200 rounded-2xl flex items-center gap-3 text-emerald-900 shadow-sm animate-fade-in-down backdrop-blur-sm">
      <div class="w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center shrink-0">
        <svg class="w-5 h-5 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" /></svg>
      </div>
      <span class="font-medium">{{ toast }}</span>
    </div>

    <div *ngIf="error" class="mb-6 p-4 bg-red-50 border border-red-100 rounded-2xl flex items-center gap-3 text-red-800 shadow-sm animate-fade-in-down">
      <svg class="w-5 h-5 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>
      <span class="font-medium">{{ error }}</span>
    </div>

    <div *ngIf="loading" class="space-y-8 animate-pulse mt-4">
      <div class="h-24 bg-emerald-900/5 rounded-2xl w-full"></div>
      <div class="h-24 bg-emerald-900/5 rounded-2xl w-full"></div>
      <div class="h-32 bg-emerald-900/5 rounded-2xl w-full"></div>
    </div>

    <form *ngIf="!loading" [formGroup]="form" class="space-y-8 mt-2">

      <section class="bg-white/60 backdrop-blur-md border border-white/60 p-6 rounded-3xl shadow-sm space-y-6">
        <h3 class="text-lg font-bold text-emerald-950 flex items-center gap-2 border-b border-emerald-100/50 pb-4">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-emerald-600">
            <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
          </svg>
          General Information
        </h3>

        <div class="group">
          <label class="block text-xs font-bold text-emerald-800 uppercase tracking-wider mb-2 ml-1">Organization name</label>
          <div class="relative">
            <input type="text"
                   formControlName="title"
                   class="w-full pl-4 pr-4 py-3 bg-white border border-emerald-100 rounded-xl text-emerald-950 font-semibold placeholder:text-emerald-900/30 outline-none focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 transition-all shadow-sm"
                   placeholder="e.g.: Friends of Nature..." />

            <div *ngIf="form.controls.title.touched && form.controls.title.invalid" class="absolute right-3 top-3 text-red-500">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" />
              </svg>
            </div>
          </div>
          <p *ngIf="form.controls.title.touched && form.controls.title.invalid" class="text-xs text-red-600 mt-1.5 ml-1 font-medium animate-pulse">
            Title is required (max 80 characters).
          </p>
        </div>
      </section>

      <section class="bg-white/60 backdrop-blur-md border border-white/60 p-6 rounded-3xl shadow-sm space-y-6" formArrayName="suggestedAmounts">
        <div class="flex items-center justify-between border-b border-emerald-100/50 pb-4">
          <h3 class="text-lg font-bold text-emerald-950 flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-emerald-600">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z" />
            </svg>
            Donation grid
          </h3>
          <span class="text-xs font-semibold bg-emerald-100 text-emerald-700 px-2 py-1 rounded-lg">5 amounts</span>
        </div>

        <div>
          <p class="text-sm text-emerald-800/70 mb-4">Set the default suggested amounts for donors (€).</p>

          <div class="grid grid-cols-2 md:grid-cols-5 gap-3">
            <div *ngFor="let c of suggestedAmounts.controls; let i = index" class="relative group">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <span class="text-emerald-900/40 font-bold">€</span>
              </div>

              <input type="number"
                     min="1"
                     [formControlName]="i"
                     class="w-full pl-8 pr-3 py-4 text-center bg-white border border-emerald-100 rounded-2xl text-lg font-bold text-emerald-950 outline-none focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 focus:-translate-y-1 transition-all shadow-sm placeholder:text-emerald-200"
                     placeholder="0" />

              <div *ngIf="amountCtrl(i).touched && amountCtrl(i).invalid"
                   class="absolute -bottom-6 left-0 right-0 text-center text-[10px] font-bold text-red-500 bg-red-50 py-0.5 rounded-md">
                Min €1
              </div>
            </div>
          </div>
        </div>
      </section>

    </form>
  </div>
</div>
